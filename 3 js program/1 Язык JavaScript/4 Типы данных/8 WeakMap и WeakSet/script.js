let john ={ name:"John"}

let array = [john];

john = null; // –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –æ–±—ä–µ–∫—Ç

// –æ–±—ä–µ–∫—Ç john —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤–µ, –ø–æ—ç—Ç–æ–º—É –æ–Ω –Ω–µ –±—É–¥–µ—Ç —É–¥–∞–ª—ë–Ω —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞
// –º—ã –º–æ–∂–µ–º –≤–∑—è—Ç—å –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∫ array[0]
john ={ name:"John"}
let map = new Map();
map.set(john, '...');

john = null;

for (key of map.entries()) {
    console.log( key); // john —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è
};

// WeakMap ‚Äì –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –¥—Ä—É–≥–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ —ç—Ç–æ–º –∞—Å–ø–µ–∫—Ç–µ. –û–Ω–∞ –Ω–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞, –∫–æ–≥–¥–∞ —ç—Ç–∏ –æ–±—ä–µ–∫—Ç—ã –≤—ã—Å—Ç—É–ø–∞—é—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–µ–π.
// –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö.


// WeakMap
    // –ü–µ—Ä–≤–æ–µ –µ–≥–æ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Map –≤ —Ç–æ–º, —á—Ç–æ –∫–ª—é—á–∏ –≤ WeakMap –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—ä–µ–∫—Ç–∞–º–∏, –∞ –Ω–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:
	let weakMap = new WeakMap();

	let obj = {};

	weakMap.set(obj,'ok'); // —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±—ä–µ–∫—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞

	// –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞
	// weakMap.set('test','Whoops'); // –û—à–∏–±–∫–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ "test" –Ω–µ –æ–±—ä–µ–∫—Ç

	obj = null;
	// –û–±—ä–µ–∫—Ç obj —É–¥–∞–ª—ë–Ω –∏–∑ –ø–∞–º—è—Ç–∏!

	// WeakMap –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–±–æ—Ä –∏ –º–µ—Ç–æ–¥—ã keys(), values(), entries(), —Ç–∞–∫ —á—Ç–æ –Ω–µ—Ç —Å–ø–æ—Å–æ–±–∞ –≤–∑—è—Ç—å –≤—Å–µ –∫–ª—é—á–∏ –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –Ω–µ—ë.


// –ü—Ä–∏–º–µ—Ä: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
	let visitsCountMap = new WeakMap(); // map: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å => —á–∏—Å–ª–æ –≤–∏–∑–∏—Ç–æ–≤

	// —É–≤–µ–ª–∏—á—ã–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫
	function countUser(user) {
		let count = visitsCountMap.get(user) || 0;
		visitsCountMap.set(user , ++count);
	}


	// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
		// –î—Ä—É–≥–∞—è —á–∞—Å—Ç–∞—è —Å—Ñ–µ—Ä–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è ‚Äì —ç—Ç–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–≥–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–µ–Ω –≥–¥–µ-—Ç–æ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å—Å—è (¬´–∫–µ—à–∏—Ä–æ–≤–∞—Ç—å—Å—è¬ª) –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –¥–∞–ª—å–Ω–µ–π—à–∏–µ –µ—ë –≤—ã–∑–æ–≤—ã –Ω–∞ —Ç–æ–º –∂–µ –æ–±—ä–µ–∫—Ç–µ –º–æ–≥–ª–∏ –ø—Ä–æ—Å—Ç–æ –±—Ä–∞—Ç—å —É–∂–µ –≥–æ—Ç–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—è –µ–≥–æ.
		// –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Map, –≤–æ—Ç —Ç–∞–∫:

	// üìÅ cache.js
	let cache = new Map();

	// –≤—ã—á–∏—Å–ª—è–µ–º –∏ –∑–∞–ø–æ–º–∏–Ω–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
	function process(obj) {
	if (!cache.has(obj)) {
		let result = /* —Ç—É—Ç –∫–∞–∫–∏–µ-—Ç–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ */ obj;

		cache.set(obj, result);
	}

	return cache.get(obj);
	}

	// –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ–º process() –≤ –¥—Ä—É–≥–æ–º —Ñ–∞–π–ª–µ:

	// üìÅ main.js
	obj = {/* –¥–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –∫–∞–∫–æ–π-—Ç–æ –æ–±—ä–µ–∫—Ç */};

	let result1 = process(obj); // –≤—ã—á–∏—Å–ª–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç

	// ...–ø–æ–∑–∂–µ, –∏–∑ –¥—Ä—É–≥–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –∫–æ–¥–µ...
	let result2 = process(obj); // —Ä–∞–Ω–µ–µ –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∑—è—Ç –∏–∑ –∫–µ—à–∞

	// ...–ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω:
	obj = null;

	console.log(cache.size); // 1 (–£–ø—Å! –û–±—ä–µ–∫—Ç –≤—Å—ë –µ—â—ë –≤ –∫–µ—à–µ, –∑–∞–Ω–∏–º–∞–µ—Ç –ø–∞–º—è—Ç—å!)

	// –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã process(obj) —Å —Ç–µ–º –∂–µ —Å–∞–º—ã–º –æ–±—ä–µ–∫—Ç–æ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤–µ–¥—É—Ç –∫ —Ç–æ–º—É, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑, –∞ –∑–∞—Ç–µ–º –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã –±–µ—Ä—É—Ç –µ–≥–æ –∏–∑ –∫–µ—à–∞. –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Ä—É—á–Ω—É—é –æ—á–∏—â–∞—Ç—å cache –æ—Ç —Å—Ç–∞–≤—à–∏—Ö –Ω–µ–Ω—É–∂–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–æ–≤.

	// –ù–æ –µ—Å–ª–∏ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WeakMap –≤–º–µ—Å—Ç–æ Map, —Ç–æ —ç—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∏—Å—á–µ–∑–Ω–µ—Ç: –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –ø–∞–º—è—Ç–∏ —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞


// WeakSet
	// –ö–æ–ª–ª–µ–∫—Ü–∏—è WeakSet –≤–µ–¥—ë—Ç —Å–µ–±—è –ø–æ—Ö–æ–∂–µ:
	
	// –û–Ω–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ Set, –Ω–æ –º—ã –º–æ–∂–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –≤ WeakSet —Ç–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç—ã (–Ω–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è).
	// –û–±—ä–µ–∫—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–µ —Ç–æ–ª—å–∫–æ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –≥–¥–µ-—Ç–æ –µ—â—ë.
	// –ö–∞–∫ –∏ Set, –æ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç add, has –∏ delete, –Ω–æ –Ω–µ size, keys() –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º–æ–π.
	// –ë—É–¥—É—á–∏ ¬´—Å–ª–∞–±–æ–π¬ª –≤–µ—Ä—Å–∏–µ–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –æ–Ω–∞ —Ç–æ–∂–µ —Å–ª—É–∂–∏—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞. –ù–æ –Ω–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∞ —Å–∫–æ—Ä–µ–µ –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π —Ç–∏–ø–∞ ¬´–¥–∞/–Ω–µ—Ç¬ª. –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –≤–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ WeakSet –º–æ–∂–µ—Ç —á—Ç–æ-—Ç–æ —Å–∫–∞–∑–∞—Ç—å –Ω–∞–º –æ–± –æ–±—ä–µ–∫—Ç–µ.
	
	// –ù–∞–ø—Ä–∏–º–µ—Ä, –º—ã –º–æ–∂–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ WeakSet –¥–ª—è —É—á—ë—Ç–∞ —Ç–µ—Ö, –∫—Ç–æ –ø–æ—Å–µ—â–∞–ª –Ω–∞—à —Å–∞–π—Ç:
	let visitedSet = new WeakSet();

	 john = { name: "John" };
	let pete = { name: "Pete" };
	let mary = { name: "Mary" };

	visitedSet.add(john); // John –∑–∞—Ö–æ–¥–∏–ª –∫ –Ω–∞–º
	visitedSet.add(pete); // –ø–æ—Ç–æ–º Pete
	visitedSet.add(john); // John —Å–Ω–æ–≤–∞

	// visitedSet —Å–µ–π—á–∞—Å —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

	// –ø—Ä–æ–≤–µ—Ä–∏–º, –∑–∞—Ö–æ–¥–∏–ª –ª–∏ John?
	console.log(visitedSet.has(john)); // true

	// –ø—Ä–æ–≤–µ—Ä–∏–º, –∑–∞—Ö–æ–¥–∏–ª–∞ –ª–∏ Mary?
	console.log(visitedSet.has(mary)); // false

	john = null;

	// —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö visitedSet –±—É–¥–µ—Ç –æ—á–∏—â–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏